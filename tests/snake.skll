mv_x = 0;
mv_y = 1;
&px = 0;
&py = 1;

fn = 0;
fx = 0; 
fy = 0; 

&enemies = [[0,0]];
ls_enemy = 0;

proc &key_left () { 
  mv_x = -1; mv_y = 0;
};

proc &key_right () { 
  mv_x = 1; mv_y = 0;
};

proc &key_up () { 
  mv_x = 0; mv_y = 1;
};

proc &key_down () { 
  mv_x = 0; mv_y = -1;
};

proc &key_space () { 
  maybe_eat();
};

proc &update () {
  update_tail();
  move();
  check_collision();
  maybe_spawn_food();
};

proc move () {
  &px = (&px + mv_x);
  &py = (&py + mv_y);
  if ((&px < &getLeft())) {
    &px = &getRight();
  };
  if ((&px > &getRight())) {
    &px = &getLeft();
  };
  if ((&py > &getTop())) {
    &py = &getBottom();
  };
  if ((&py < &getBottom())) {
    &py = &getTop();
  };
};

proc update_tail () {
  index = (&sizel(&enemies)-1);
  while ((index > 0)) {
    np = &getl(&enemies, (index-1));
    &enemies = &setl(&enemies, index, np);
    index = (index - 1);
  };
  &enemies = &setl(&enemies, 0, [&px,&py]); 
};

proc check_collision () {
  index = (&sizel(&enemies)-1);
  while ((index >= 0)) {
    np = &getl(&enemies, index);
    c = ((&px == &getl(np, 0)) && (&py == &getl(np, 1)));
    &completed = (&completed || c);
    index = (index - 1);
  };
};

proc maybe_eat () {
  if ( ((&px == fx) && (&py == fy)) ) {
    segment = &getl(&enemies, (&sizel(&enemies)-1));
    &enemies = &addl(&enemies, segment);
    fn = 1;
  };
};

proc maybe_spawn_food () {
  if (fn) {

  };
};




